webpackJsonp([21],{"/dld":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=o("mvHQ"),a=o.n(i),r=o("woOf"),n=o.n(r),s=o("Nv7v"),c={getShopData:{url:"/app/cart/getCart",method:"post"},addOrder:{url:"/app/order/saveCartOrder",method:"post"},deleteShopCar:{url:"/app/cart/deleteCart",method:"post"},updateAddSubCart:{url:"/app/cart/updateAddSubCart",method:"post"}},d=function(t,e){return Object(s.a)(c[t].url,c[t].method,e,{},c[t].fileConfig)},l={name:"shop-car",data:function(){return{allChecked:!1,totalPrice:0,list:[]}},mounted:function(){this.getShopCarList()},methods:{getShopCarList:function(){var t=this;d("getShopData",{pageSize:100,pageNum:1}).then(function(e){console.log("getShopData_data",e),t.list=e.data.list.map(function(t){return n()({},t,{checked:!1})}),t.allChecked=!1,t.totalPrice=t.getTotal()})},addShopCar:function(){var t=this,e=this.list.filter(function(t){return!0===t.checked});if(e.length){var o=this.list.filter(function(t){return!0===t.checked}).map(function(t){return t.goodsCode}).toString(),i=this.list.filter(function(t){return!0===t.checked}).map(function(t){return t.orderSum}).toString(),r=this.list.filter(function(t){return!0===t.checked}).map(function(t){return t.cartCode}).toString(),n=this.list.filter(function(t){return!0===t.checked}).map(function(t){return t.storeCode}).toString();console.log("选中的项payCommList",this.payCommList),console.log("storeCodes_data ",n),sessionStorage.setItem("payCommList",a()(e)),setTimeout(function(){t.$router.push({path:"/payment-info",query:{payCommList:e,goodsCode:o,orderMoney:t.totalPrice.toFixed(2),orderSum:i,cartCode:r,storeCode:n}})})}else this.$message.info("请先选择需要购买的商品")},deleteShopCar:function(){var t=this;if(this.list.filter(function(t){return!0===t.checked}).length){var e=this.list.filter(function(t){return!0===t.checked}).map(function(t){return t.cartCode}).toString();d("deleteShopCar",{cartCode:e}).then(function(e){0===e.code?(t.$message.success(e.msg),t.getShopCarList()):t.$message.error(e.msg)})}else this.$message.info("请先选择需要删除的商品")},allInputChange:function(){var t=this;this.allChecked=!this.allChecked,this.list.forEach(function(e){e.checked=t.allChecked}),this.totalPrice=this.getTotal()},inputChange:function(t){t.checked=!t.checked;for(var e=0;e<this.list.length;e++){if(!1===this.list[e].checked){this.allChecked=!1;break}this.allChecked=!0}this.totalPrice=this.getTotal()},countDelete:function(t){t.orderSum>1&&(t.orderSum=parseFloat(t.orderSum)-1),d("updateAddSubCart",{cartCode:t.cartCode,orderSum:t.orderSum}).then(function(t){}),this.totalPrice=this.getTotal()},countAdd:function(t){t.orderSum=parseFloat(t.orderSum)+1,d("updateAddSubCart",{cartCode:t.cartCode,orderSum:t.orderSum}).then(function(t){}),this.totalPrice=this.getTotal()},getTotal:function(){var t=0;return this.list.forEach(function(e){e.checked&&(t+=parseFloat(e.orderSum*e.salePrice))}),parseFloat(t.toFixed(2))}}},u={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"container"},[i("ul",{staticClass:"book-list"},t._l(t.list,function(e,a){return i("li",{key:a,staticClass:"book-list-item"},[i("div",{staticClass:"select-btn-box"},[i("div",[i("input",{attrs:{type:"checkbox"},on:{change:function(o){return t.inputChange(e)}}}),t._v(" "),i("div",{staticClass:"action",style:{display:e.checked?"block":"none"}})])]),t._v(" "),i("div",{staticClass:"book-count-info"},[i("img",{directives:[{name:"show",rawName:"v-show",value:e.imagePath,expression:"item.imagePath"}],attrs:{src:e.imagePath}}),t._v(" "),i("img",{directives:[{name:"show",rawName:"v-show",value:!e.imagePath,expression:"!item.imagePath"}],attrs:{src:o("psQ+")}}),t._v(" "),i("div",[i("div",[t._v(t._s(e.goodsName))]),t._v(" "),i("div",[t._v("圆若骊珠，赤若金丸，肉似玻璃，核如黑漆。")]),t._v(" "),i("div",[i("span",[t._v("￥"+t._s(e.salePrice*e.orderSum))]),t._v(" "),i("div",{staticClass:"change-count-box"},[i("div",{on:{click:function(o){return t.countDelete(e)}}},[t._v("-")]),t._v(" "),i("div",[t._v(t._s(e.orderSum))]),t._v(" "),i("div",{on:{click:function(o){return t.countAdd(e)}}},[t._v("+")])])])])])])}),0),t._v(" "),i("div",{staticClass:"close-count"},[i("div",[i("div",[i("input",{attrs:{type:"checkbox"},on:{change:t.allInputChange}}),t._v(" "),i("div",{staticClass:"action",style:{display:t.allChecked?"block":"none"}})]),t._v(" "),i("span",[t._v("全选")])]),t._v(" "),i("div",[i("div",[i("b",[t._v("合计:")]),t._v(" "),i("span",[t._v(t._s(t.totalPrice.toFixed(2)))])]),t._v(" "),i("el-button",{staticClass:"div-button",attrs:{type:"info"},on:{click:t.deleteShopCar}},[t._v("删除")]),t._v(" "),i("el-button",{staticClass:"div-button",attrs:{type:"primary"},on:{click:t.addShopCar}},[t._v("结算")])],1)])])},staticRenderFns:[]};var h=o("VU/8")(l,u,!1,function(t){o("fZ6Y")},"data-v-391f99a9",null);e.default=h.exports},fZ6Y:function(t,e){}});
//# sourceMappingURL=21.e661e4ce3fb73326b825.js.map